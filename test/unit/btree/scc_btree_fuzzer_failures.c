#include <inspect/btree_inspect.h>
#include <scc/btree.h>
#include <scc/mem.h>

#include <unity.h>

int ucompare(void const *l, void const *r) {
    return *(unsigned char const *)l - *(unsigned char const *)r;
}

static void run_fuzzer_test(void *restrict tree, unsigned char const *restrict data, size_t size) {
    scc_btree(unsigned char) btree = tree;

    for(size_t i = 0u; i < size; ++i) {
        TEST_ASSERT_TRUE(scc_btree_insert(&btree, data[i]));
        TEST_ASSERT_EQUAL_UINT32(0u, scc_btree_inspect_invariants(btree));
        TEST_ASSERT_EQUAL_UINT64(scc_btree_size(btree), scc_btree_inspect_size(btree));
    }
    unsigned char const *p;
    for(size_t i = 0u; i < size; ++i) {
        TEST_ASSERT_TRUE(scc_btree_remove(btree, data[i]));
        TEST_ASSERT_EQUAL_UINT32(0u, scc_btree_inspect_invariants(btree));
        TEST_ASSERT_EQUAL_UINT64(scc_btree_size(btree), scc_btree_inspect_size(btree));

        for(size_t j = i + 1u; j < size; ++j) {
            p = scc_btree_find(btree, data[j]);
            TEST_ASSERT_TRUE(p);
            TEST_ASSERT_EQUAL_UINT8(data[j], *p);
        }
    }
}

void test_scc_btree_fuzzer_failure0(void) {
    static unsigned char const data[] = {
        0,   72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  44,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   118, 118, 118, 118, 118

    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 10);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure1(void) {
    static unsigned char const data[] = {
        10,  0,   0,   0,   0,   0,   72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  255, 255,
        255, 179, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 11,  10,  0,   0,   0,   0,   0,   72,  255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 252, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  44,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   128, 0,   0,   0,   0,
        0,   118, 118, 118, 118, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 138, 69,  0,   0,
        144, 97,  0,   0,   255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 72,  72,
        72,  72,  118, 72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  44,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   118, 118,
        118, 118, 118
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 11);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure2(void) {
    static unsigned char const data[] = {
        0,   72,  72,  72,  72,  72,  72,  72,  0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 1,   0,   0,   0,   0,
        0,   0,   0,   255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 138, 69,  0,   0,   144, 97,
        0,   0,   255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        44,  72,  72,  72,  72,  72,  72,  0, 0, 0, 0, 0, 0,
        0,   0,   72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 1,   0,   0,   0,   0,
        0,   0,   0,   255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 138, 69,  0,   0,   144, 97,
        0,   0,   255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   166, 0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        72,  45,  72,  72,  72,  72,  72,  72,  72,  72,  72,
        72,  72,  72,  72,  72,  72,  72,  72,  72,  0,   0,
        0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   98,  0,   0,   0,   0,   0,   0,   0,
        0,   0,   0,   0,   0,   0,   118, 118, 118, 118, 118
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 10);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure3(void) {
    static unsigned char const data[] = {
        0x01, 0x00, 0x00, 0x62, 0xb0, 0x00, 0x52, 0xa5,
        0x74, 0x00, 0xe9
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x04);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure4(void) {
    static unsigned char const data[] = {
        0x0e, 0x0e, 0x03, 0x14, 0x00, 0xbb, 0x00, 0x0e,
        0x0e, 0x03, 0x14, 0x00, 0xbb, 0x00, 0xe1
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x0e);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure5(void) {
    static unsigned char const data[] = {
        0x01, 0x00, 0x00, 0x62, 0xb0, 0x00, 0x42,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x49, 0x00, 0xe9
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x04);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure6(void) {
    static unsigned char data[] = {
        0x01, 0x00, 0x00, 0x62, 0xb0, 0x00, 0x42, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa5,
        0x74, 0x00, 0xe9
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x04);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure7(void) {
    unsigned char data[] = {
        0x00, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x0e, 0x00, 0x80, 0x00, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x00, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x00, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x76, 0x76,
        0x76, 0x76
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x0a);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure8(void) {
    unsigned char data[] = {
        0x00, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x2c,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x76, 0x76, 0x76, 0x76, 0x76
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x0a);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure9(void) {
    static unsigned char const data[] = {
        0x31, 0x00, 0xbb, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0xf7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0x52, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0xff, 0xff, 0xff, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xf7, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x52, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0xff, 0xff, 0xff, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0xf7, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x52, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0xff,
        0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
        0xf1, 0x00, 0xe1
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x08);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure10(void) {
    static unsigned char const data[] = {
        0x00, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x7e, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x68, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x68, 0x48, 0x48, 0x48, 0x48, 0x48,
        0x48, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x05, 0x00,
        0x00, 0x00, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb, 0xeb,
        0xeb, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16,
        0x16, 0x16, 0x16, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76,
        0x76, 0x76, 0x76, 0x76
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x0a);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure11(void) {
    static unsigned char const data[] = {
        0x32, 0x00, 0xe1
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure12(void) {
    static unsigned char const data[] = {
        0x29, 0x9a, 0x00, 0xe1
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure13(void) {
    static unsigned char const data[] = {
        0x14, 0x00, 0x00, 0x00, 0xbb, 0x00, 0xe1
    };

    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure14(void) {
    static unsigned char const data[] = {
        0,   0,   0,   0,   36,  36,  36, 36,
        36,  36,  36,  36,  40,  0,   0,   0,
        36,  36,  36,  36,  0,   0,   0,   0,
        0,   36,  36,  36,  36,  36,  36, 36,
        36,  36,  36,  36,  44,  36,  36, 36,
        170, 170, 170, 170, 170, 170, 90, 170,
        170, 219
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x04);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure15(void) {
    static unsigned char const data[] = {
        3,  3,   3,   3,   3,   3,   3,
        3,  3, 250, 255, 225, 226
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure16(void) {
    static unsigned char const data[] = {
        0x03, 0x03, 0xc6, 0xe2, 0xb9, 0x72, 0x00, 0xb5,
        0xff, 0x7f, 0x00, 0x00
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}

void test_scc_btree_fuzzer_failure17(void) {
    static unsigned char const data[] = {
        0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
        0x03, 0x03, 0xfa, 0xff, 0xff, 0xff, 0xff, 0x07,
        0xe1, 0xe2,
    };
    scc_btree(unsigned char) btree = scc_btree_with_order(unsigned char, ucompare, 0x03);
    run_fuzzer_test(btree, data, scc_arrsize(data));
    scc_btree_free(btree);
}
